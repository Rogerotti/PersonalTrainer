@model  IEnumerable<Framework.Models.Dto.UserDto>
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    ViewData["Title"] = "Users";
    Layout = "Layout";
}

<style>

   td.h2 {
color: red;
}
        pad-right {
        padding-right: 2em;
    }

    pad-top {
        padding-top: 2em;
    }

    pad-bottom {
        padding-bottom: 2em;
    }

    .margin-top {
        margin-top: 2em;
    }

        .margin-bottom {
        margin-bottom: 2em;
    }
</style>

@section LeftPanel
{
    @await Component.InvokeAsync("LeftMenu")
}

<body>

    <div class="ui two column middle aligned very relaxed stackable grid">

        <div class="two width column">

            <form id="showTest" method="post" asp-controller="Diet" asp-action="ProductList">

                <table id="table" class="ui sortable selectable celled  table">

                    <thead>
                        <tr>
                            <th hidden>Id column</th>
                            <th class="sorted ascending">@Framework.Resources.UserLanguage.Login</th>
                            <th>@Framework.Resources.UserLanguage.Email</th>
                            <th>@Framework.Resources.UserLanguage.Age</th>
                        </tr>
                    </thead>

                    <tbody>
                  
                        @foreach (var item in Model)
                        {
                            <tr onclick="showDetails(this)">
                                <td hidden><input id="selectedUserId" type="hidden" value="@item.UserId" /></td>
                                <td>@item.Login</td>
                                <td>@item.Email</td>
                                <td>@item.Age</td>
                            </tr>
                        }
                      
                    </tbody>

            </table>

            </form>

    </div>

    <div class="column">

        <div class="ui seven column row">

            <div class="column">
                <div class="field">
                    <div>
                        <strong>@Framework.Resources.UserLanguage.Login: </strong>
                        <label id="userName"></label>
                    </div>
                </div>
            </div>

            <div class="column">
                <div class="field">
                    <strong>@Framework.Resources.UserLanguage.Email: </strong>
                    <label id="userEmail"></label>
                </div>
            </div>

            <div class="column">
                <div class="field">
                    <strong>@Framework.Resources.UserLanguage.Age: </strong>
                    <label id="userAge"></label>
                </div>
            </div>

            <div class="column row">
                <form asp-controller="Diet" asp-action="AddEditProduct" method="get">
                    <input type="hidden" name="productId" value="" />
                    <button disabled id="editButton" class="ui blue tiny button" type="submit">@Framework.Resources.ButtonLanguage.Edit</button>
                </form>
            </div>

        </div>

    </div>

</div>

</body>

@section Scripts
{
<script>

    $(document).ready(function () {
        $('.sortable.table').tablesort();
    });

    function showDetails(b) {
        var rows = $('#table > tbody > tr')
        for (var i = 0; i < rows.length; i++)
            rows.eq(i).attr('class', ' ');

        $(b).attr('class', 'active')

        var guidId = $("[id='selectedUserId']", b).val();
        var data = { Id: guidId };

        $.ajax({
            url: '@Url.Action("GetUserDetails", "Admin")',
            type: "POST",
            data: JSON.stringify(data),
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            success: function (msg) {
                $('#userName').text(msg.login);
                $('#userEmail').text(msg.email);
                $('#userAge').text(msg.age);
            },

            error: function (xhr, ajaxOptions, thrownError) {
                alert(xhr.status);
                alert(thrownError);
            }
        });
    }
</script>
}
